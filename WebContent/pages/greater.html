	<div>
		<img src="images/backgroud3.png" width="100%"/>
	</div>
	<div class="container-fluid" style="margin-left: 30%;margin-right: 30%;">
		<div id="preview-pane" style="margin: 2% auto 2% 50%;">
			<div class="preview-container">
				<img id="icon_greater" class="jcrop-preview" style="width: 100px;height: 100px;cursor: pointer;" src="images/upload_image.jpg" onclick="uploadIcon();"/>
			</div>
		</div>
		<form id="greaterForm" class="form-horizontal">
		  <div class="form-group">
		    <label for="nickname" class="col-sm-2 control-label">姓&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp名</label>
		    <div class="col-sm-10">
		      <input style="text-align: right;" required="required" class="form-control" id="nickname" placeholder="您的姓名">
		    </div>
		  </div>
		  <div class="form-group">
		     <label for="company" class="col-sm-2 control-label">公&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp司</label>
		     <div class="col-sm-10">
		       <input class="form-control" required="required" id="company" placeholder="您的公司">
		     </div>
		  </div>
		  <div class="form-group">
		     <label for="post" class="col-sm-2 control-label">职&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp位</label>
		     <div class="col-sm-10">
		       <input class="form-control" required="required" id="post" placeholder="您的职位">
		     </div>
		  </div>
		 <div class="form-group">
		     <label for="industry" class="col-sm-2 control-label">行&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp业</label>
		     <div class="col-sm-10">
		       <select class="form-control" id="industry" style="text-align: right;">
				  <option value="0">互联网</option>
				  <option value="1">金融</option>
				  <option value="2">快消品</option>
				  <option value="3">广告</option>
				  <option value="4">咨询</option>
				  <option value="5">会计事务所</option>
				  <option value="6">其他</option>
				</select>
		     </div>
		  </div>
		  <div class="form-group">
		     <label for="schoolName" class="col-sm-2 control-label">大&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp学</label>
		     <div class="col-sm-10">
					     <div class="input-group">
	                        <input type="text" class="form-control" id="school">
	                        <div class="input-group-btn">
	                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
	                                <span class="caret"></span>
	                            </button>
	                            <ul class="dropdown-menu dropdown-menu-right" role="menu">
	                            </ul>
	                        </div>
	                        <!-- /btn-group -->
	                    </div>
                    </div>
		  </div>
		  <div class="form-group">
		     <label for="workYears" class="col-sm-2 control-label">工作经验</label>
		     <div class="col-sm-10">
		       <select class="form-control" id="workYears">
				  <option value="1">一年</option>
				  <option value="2">两年</option>
				  <option value="3">三年</option>
				  <option value="4">四年</option>
				  <option value="5">五年</option>
				  <option value="6">五年以上</option>
				</select>
		     </div>
		  </div>
		  <div class="form-group">
		     <label for="online_startTime" class="col-sm-2 control-label">空闲时间</label>
		     <div class="col-sm-4" style="width: 37.5%;">
		       <select class="form-control" id="online_startTime">
				  <option>08:00</option>
				  <option>09:00</option>
				  <option>10:00</option>
				  <option>11:00</option>
				  <option>12:00</option>
				  <option>13:00</option>
				  <option>14:00</option>
				  <option>15:00</option>
				  <option>16:00</option>
				  <option>17:00</option>
				  <option>18:00</option>
				  <option>19:00</option>
				  <option>20:00</option>
				  <option>21:00</option>
				  <option>22:00</option>
				  <option>23:00</option>
				  <option>24:00</option>
				</select>
		     </div>
		     <label for="online_endTime" class="col-sm-1 control-label">至</label>
		     <div class="col-sm-4" style="width: 37.5%;">
		       <select class="form-control" id="online_endTime">
				  <option>08:00</option>
				  <option>09:00</option>
				  <option>10:00</option>
				  <option>11:00</option>
				  <option>12:00</option>
				  <option>13:00</option>
				  <option>14:00</option>
				  <option>15:00</option>
				  <option>16:00</option>
				  <option>17:00</option>
				  <option>18:00</option>
				  <option>19:00</option>
				  <option>20:00</option>
				  <option>21:00</option>
				  <option>22:00</option>
				  <option>23:00</option>
				  <option>24:00</option>
				</select>
		     </div>
		  </div>
		  <div class="form-group">
		     <label for="tags" class="col-sm-2 control-label">个性标签</label>
		     <div class="col-sm-10">
		       <textarea class="form-control" id="tags" placeholder="您的个性标签,多个之间以逗号隔开" rows="4"/>
		     </div>
		  </div>
		  <div class="form-group">
		     <label for="introduce" class="col-sm-2 control-label">个人简介</label>
		     <div class="col-sm-10">
		       <textarea class="form-control" id="introduce" required="required" placeholder="您的个人简介(介绍自己,怎么风趣怎么来,幽默的人最有魅力)" rows="4"/>
		     </div>
		  </div>
		  <div class="form-group">
		    <div class="col-sm-offset-6 col-sm-10">
		      <button id="apply" type="button" class="btn btn-primary" data-container="body" data-placement="right" data-content="">提交申请</button>
		      <button id="greater_warning" style="visibility: hidden;" type="button" class="btn btn-primary" data-container="body" data-placement="right" data-content=""></button>
		    </div>
		  </div>
		</form>
	</div>
	
	<div class="modal fade" id="uploadModal">
	  <div class="modal-dialog">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h4 class="modal-title">附件上传</h4>
	      </div>
	      <div class="modal-body" >
	        <form class="form-horizontal">
			  <div class="form-group">
			    <div class="col-sm-9">
				    <div class="col-sm-9">
				      	 <input type="file" class="form-control" id="fileToUpload" name="fileToUpload">
				    	 <input type="hidden" id="x" name="x" value="0"/>  
			             <input type="hidden" id="y" name="y" value="0"/>  
			             <input type="hidden" id="w" name="w" value="300"/>  
			             <input type="hidden" id="h" name="h" value="300"/>  
				    </div>
			    </div>
			   </div>
			   <div class="form-group" style="height: 300px;">
			    <div class="col-sm-8">
				   <div class="jc-demo-box">
  						<img style="width: 300px;height: 300px;" src="" id="uploadImage" alt="图片区域"/>
					</div>
			    </div>
			    <div class="col-sm-4">
			    	<div id="preview-pane">
					    <div class="preview-container">
					      	<img  id="previewImage" style="width: 100px;height: 100px;" src="" class="jcrop-preview" alt=""/>
					   	</div>
					</div>
				</div>
			  </div>
			</form>
	      </div>
	      <div class="modal-footer">
	        <button id="okBtn" type="button" class="btn btn-primary">确定</button>
	      </div>
	    </div>
	  </div>
	</div>
<script type="text/javascript">
/**
 * 不显示下拉按钮
 */
$("#school").bsSuggest({
    url: baseUrl + '/listSchools',
    /* effectiveFields: ["id","name"],
    searchFields: [ "name"],
    effectiveFieldsAlias:{id: "序号",name: "学校"}, */
    showBtn: false,
    idField: "id",
    keyField: "name"
}).on('onDataRequestSuccess', function (e, result) {
    console.log('onDataRequestSuccess: ', result);
}).on('onSetSelectValue', function (e, keyword) {
    console.log('onSetSelectValue: ', keyword);
}).on('onUnsetSelectValue', function (e) {
    console.log("onUnsetSelectValue");
});

$("#greaterForm input").on('blur',function(){
	if($(this).attr("required") == "required")
	{
		if($(this).val().trim() == ""){
			$(this).parent().addClass("has-error");
		}
		else{
			$(this).parent().removeClass("has-error");
		}
	}else{
		
	}
});

$('#apply').on('blur',function(e){
	$('#greater_warning').attr("data-content","");
	$('#greater_warning').popover("hide");
});

$('#apply').on('click',function(e){
	e.preventDefault(); 
	var image = $("#icon_greater").attr("src");
	if(image == '' || image == "images/upload_image.jpg"){
		msg = "请选择上传头像";
		$('#greater_warning').attr("data-content",msg);
		$('#greater_warning').popover("show");
		return false;
	}
	
	var res = validateForm("greaterForm");
	if(!res.isPass){
		$('#greater_warning').attr("data-content",res.msg);
		$('#greater_warning').popover("show");
		return false;
	}
	
	var postData = parseFormToJson("greaterForm");
	postData.id = userId;
	postData.image = image;
	postData.w = $("#w").val();
	postData.h = $("#h").val();
	postData.x = $("#x").val();
	postData.y = $("#y").val();
	
	if($("#school").attr("data-id") == ""){
		$('#greater_warning').attr("data-content","请选择正确的学校");
		$('#greater_warning').popover("show");
		return false;
	}
	postData.schoolId=$("#school").attr("data-id");
	
	
	$.ajax({
		type:'post',
		url:baseUrl + '/becomeGreater',
		data:postData,
		dataType:'json',
		success:function(data){
			setTimeout(function(){
				$("#activity").show();
				$("#greater").hide();
				$("#icon").attr("src",serverUrl+ data.url);
				$("#mainDiv").load("pages/userInfo.html");
			},600);
		},
		error:function(textStatus,errorThrown){
			isClick = false;
		}
	});
});

function uploadIcon(){
	$("#uploadModal").modal("show");
	$('#fileToUpload').val("");
	$(".jc-demo-box").empty();
	$('.jc-demo-box').append("<img style=\"width: 30	0px;height: 300px;text-align: center;\" class=\"img-responsive\" src=\"\" id=\"uploadImage\" alt=\"图片区域\"/>");
	$('#previewImage').attr("src","");
}

$('#fileToUpload').on('change', function(){
	var fileSize = getFileSize(document.getElementById("fileToUpload"));
	if(fileSize > 2*1024*1024)
	{
		$('#fileToUpload').val("");
		$(".jc-demo-box").empty();
		$('.jc-demo-box').append("<img style=\"width: 300px;height: 300px;text-align: center;\" class=\"img-responsive\" src=\"\" id=\"uploadImage\" alt=\"图片区域\"/>");
		$('#previewImage').attr("src","");
		alert("文件大小不能超过2M");
		return;
	}
	
	$("#x").val(0);  
    $("#y").val(0);  
    $("#w").val(300);  
    $("#h").val(300);  
		
	var reader = new FileReader();
	reader.onload = function(e) {
		var xsize = $('#preview-pane .preview-container').width();
		var ysize = $('#preview-pane .preview-container').height();
		$(".jc-demo-box").empty();
		$('.jc-demo-box').append("<img style=\"width: 300px;height: 300px;\" class=\"img-responsive\" src=\""+ e.target.result+"\" id=\"uploadImage\"/>");
		$('#previewImage').attr("src",e.target.result);
		$('#uploadImage').Jcrop({
			  onChange: updatePreview,
			  onSelect: updatePreview,
			  aspectRatio: xsize / ysize
			},function(){
			  var bounds = this.getBounds();
			  boundx = bounds[0];
			  boundy = bounds[1];
			  jcrop_api = this;
			
			  // Move the preview into the jcrop container for css positioning
			  //$('#preview-pane').appendTo(jcrop_api.ui.holder);
			}); 
	}
	reader.readAsDataURL(this.files[0]);
	this.files = [];
});

$("#okBtn").bind("click",function(){
	$("#uploadModal").modal("hide");
	var pimg = $('#preview-pane .preview-container img');
	$("#icon_greater").attr("src",$("#uploadImage").attr("src"));
	$("#icon_greater").css({
		width:pimg.css("width"),
		height:pimg.css("height"),
		marginLeft:pimg.css("marginLeft"),
		marginTop:pimg.css("marginTop")
	});
});

function updatePreview(c)
{
	$("#x").val(c.x);  
    $("#y").val(c.y);  
    $("#w").val(c.w);  
    $("#h").val(c.h);  
	var xsize = $('#preview-pane .preview-container').width();
	var ysize = $('#preview-pane .preview-container').height();
	var pimg = $('#preview-pane .preview-container img');
  	if (parseInt(c.w) > 0)
  	{
    	var rx = xsize / c.w;
    	var ry = ysize / c.h;

    	pimg.css({
      		width: Math.round(rx * boundx) + 'px',
      		height: Math.round(ry * boundy) + 'px',
      		marginLeft: '-' + Math.round(rx * c.x) + 'px',
      		marginTop: '-' + Math.round(ry * c.y) + 'px'
    	});
  }
}

//获取获取文件大小
function getFileSize(fileObj){　　
	var  Sys = {};
	if(navigator.userAgent.indexOf("MSIE")>0)
		Sys.ie=true;
	    
	if(navigator.userAgent.indexOf("Firefox")>0)
		Sys.firefox=true;
	var filesize =0;
	if(Sys.firefox){
		filesize = fileObj.files[0].size;
	}else{
		filesize = fileObj.files[0].size;
	}
	return filesize;
}

</script>